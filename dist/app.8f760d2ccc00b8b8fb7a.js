!function(e){var n={};function t(r){if(n[r])return n[r].exports;var o=n[r]={i:r,l:!1,exports:{}};return e[r].call(o.exports,o,o.exports,t),o.l=!0,o.exports}t.m=e,t.c=n,t.d=function(e,n,r){t.o(e,n)||Object.defineProperty(e,n,{enumerable:!0,get:r})},t.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},t.t=function(e,n){if(1&n&&(e=t(e)),8&n)return e;if(4&n&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(t.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&n&&"string"!=typeof e)for(var o in e)t.d(r,o,function(n){return e[n]}.bind(null,o));return r},t.n=function(e){var n=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(n,"a",n),n},t.o=function(e,n){return Object.prototype.hasOwnProperty.call(e,n)},t.p="",t(t.s=0)}({"/IXG":function(e,n){!function(e){"use strict";e.module("linagora.esn.group").config(["$stateProvider",function(e){e.state("admin.domain.groups",{url:"/groups",views:{"root@admin":{template:"<admin-groups />"}}}).state("admin.domain.groups.display",{url:"/:groupId",views:{"root@admin":{template:"<group-display />"}}})}])}(angular)},"/iPH":function(e,n){!function(e){"use strict";function n(e){return{addMembers:function(n,t){return e.one("groups",n).post("members",t,{action:"add"})},create:function(n){return e.all("groups").post(n)},deleteGroup:function(n){return e.one("groups",n).remove()},get:function(n){return e.one("groups",n).get()},getFromEmail:function(e){return n({email:e,limit:1})},list:n,update:function(n,t){return e.one("groups",n).customPOST(t)},getAllMembers:function(e){return t(e,{limit:0})},getMembers:t,removeMembers:function(n,t){return e.one("groups",n).post("members",t,{action:"remove"})},search:function(e,t,r){return n({query:e,limit:t,offset:r})}};function n(n){return e.all("groups").getList(n)}function t(n,t){return e.one("groups",n).all("members").getList(t)}}n.$inject=["groupRestangular"],e.module("linagora.esn.group").factory("groupApiClient",n)}(angular)},0:function(e,n,t){t("9kT/"),t("5MG8"),t("CBFs"),t("n1Yi"),t("/IXG"),t("SvS5"),t("VTQ0"),t("0ykG"),t("LtlO"),t("/iPH"),t("EVGR"),t("2WUN"),t("f104"),t("Sdqo"),t("lYZu"),t("iZOy"),t("M9C+"),t("1dMT"),t("f6zk"),t("vSUO"),t("4TDg"),t("Vby5"),t("tFfR"),t("C1WR"),t("cG5k"),t("bAK3"),t("MNlq"),t("pofz"),t("BifT"),t("uI/m"),t("elxr"),t("I+oS"),t("vBWL"),t("8uSL"),t("hx5j"),t("ZTNP"),t("AcaS"),t("fFpz"),t("oKFj"),t("uhLr"),t("So+R"),t("MbaL"),t("f8Gw"),e.exports=t("ZOQz")},"0ykG":function(e,n){!function(e){"use strict";e.module("linagora.esn.group").run(["esnMemberResolverRegistry","groupMemberResolverService","GROUP_OBJECT_TYPE",function(e,n,t){e.addResolver({objectType:t,resolve:n})}]).run(["attendeeService","groupAttendeeProvider",function(e,n){e.addProvider(n)}])}(angular)},"1dMT":function(e,n){!function(e){"use strict";function n(e,n){var t=this;t.$onInit=function(){t.isSelectedAll=!1,e.$watch((function(){return t.items.length&&t.items.length===n.getSelectedItems().length}),(function(e){t.isSelectedAll=!!e}))},t.$onDestroy=function(){n.unselectAllItems()},t.toggleSelectAll=function(){t.isSelectedAll?(t.isSelectedAll=!1,n.unselectAllItems()):(t.isSelectedAll=!0,t.items.forEach((function(e){n.toggleItemSelection(e,t.isSelectedAll)})))}}n.$inject=["$scope","groupSelectionService"],e.module("linagora.esn.group").controller("groupSelectionSelectAllController",n)}(angular)},"2WUN":function(e,n){!function(e){"use strict";function n(e){return function(n){return e.getFromEmail(n).then((function(n){return n.data.length?e.getAllMembers(n.data[0].id).then((function(e){return e.data})):$q.when([])}))}}n.$inject=["groupApiClient"],e.module("linagora.esn.group").factory("groupMemberResolverService",n)}(angular)},"4TDg":function(e,n){!function(e){"use strict";e.module("linagora.esn.group").component("groupDisplay",{templateUrl:"/group/app/display/group-display.html",controller:"GroupDisplayController"})}(angular)},"5MG8":function(e,n){!function(e){"use strict";e.module("linagora.esn.group").component("adminGroupsMenuItem",{templateUrl:"/group/app/admin/admin-groups-menu-item.html",bindings:{displayIn:"<"}})}(angular)},"8uSL":function(e,n){!function(e){"use strict";e.module("linagora.esn.group").component("groupMemberListItemEmail",{templateUrl:"/group/app/member/list-item-email/group-member-list-item-email.html",bindings:{member:"<"}})}(angular)},"9kT/":function(e,n){!function(e){"use strict";e.module("linagora.esn.group",["op.dynamicDirective","restangular","esn.router","esn.member","esn.http","esn.infinite-list","esn.core","esn.user","esn.async-action","esn.session","esn.attendee","esn.scroll","esn.ui","esn.i18n","esn.header"])}(angular)},AcaS:function(e,n){!function(e){"use strict";e.module("linagora.esn.group").component("groupMemberListItem",{templateUrl:"/group/app/member/list-item/group-member-list-item.html",bindings:{member:"<"}})}(angular)},BifT:function(e,n){!function(e){"use strict";function n(e,n,t,r,o,u,i,l){var a=this,c=l||20;function s(){return a.options.offset=a.elements.length,o.list(a.options).then((function(e){return e.data}))}function p(){a.options={offset:0,limit:c},m()}function m(){a.elements=[],a.infiniteScrollCompleted=!1,a.loadMoreElements=r(a,s,null,c),a.loadMoreElements()}function g(){a.options.query&&p(),t({templateUrl:"/group/app/create/group-create.html",backdrop:"static",placement:"center",controllerAs:"$ctrl",controller:"GroupCreateController"})}a.options={offset:0,limit:c},a.$onInit=function(){a.onCreateBtnClick=g,a.deleteGroup=u.deleteGroup,a.loadMoreElements=r(a,s,null,c),n.$on(i.GROUP_CREATED,(function(e,n){!function(e){if(!e)return;a.elements.unshift(e)}(n)})),n.$on(i.GROUP_DELETED,(function(n,t){var r;r=t,e.remove(a.elements,{id:r.id})}))},a.search=function(e){a.options={query:e,offset:0,limit:c},m()},a.clearSearch=p}n.$inject=["_","$scope","$modal","infiniteScrollHelper","groupApiClient","groupService","GROUP_EVENTS","ELEMENTS_PER_REQUEST"],e.module("linagora.esn.group").controller("GroupListController",n)}(angular)},C1WR:function(e,n){!function(e){"use strict";e.module("linagora.esn.group").component("groupForm",{templateUrl:"/group/app/form/group-form.html",bindings:{group:"=",newMembers:"=",updateMode:"@"},controller:"GroupFormController"})}(angular)},CBFs:function(e,n){!function(){"use strict";angular.module("linagora.esn.group").component("adminGroupsSubheader",{templateUrl:"/group/app/admin/admin-groups-subheader.html"})}()},EVGR:function(e,n){!function(e){"use strict";e.module("linagora.esn.group").directive("groupApplicationMenu",["applicationMenuTemplateBuilder",function(e){return{restrict:"E",replace:!0,template:e("/#/group",{url:"/group/images/group-icon.svg"},"Group")}}])}(angular)},"I+oS":function(e,n){!function(e){"use strict";function n(e,n,t,r,o,u,i){var l=this;function a(e){e&&e.id&&e.objectType&&"email"!==e.objectType&&l.excludedMembers.push({id:e.id,objectType:e.objectType})}l.excludedMembers=[],l.search=function(e){return u.searchMemberCandidates(e,l.excludedMembers)},l.$onInit=function(){l.group&&l.group.id&&(a({id:l.group.id,objectType:i}),!t.isEmpty(l.group.members)&&l.group.members.forEach((function(e){a(e.member)})));l.autofocus&&n((function(){e.find("tags-input input").focus()}),0)},l.onTagAdded=function(n){a(n),r.autoScrollDown(e.find("div.tags"))},l.onTagAdding=function(e){var n=o.isValidEmail(e.email)&&(r=e,i=l.newMembers,!t.find(i,{email:r.email}));var r,i;if(!n||!l.group)return l.error=!n&&"invalidEmail",n;if(!l.group.id)return n;return u.isGroupMemberEmail(l.group.id,e.email).then((function(e){return l.error=!e&&"existedMember",e}))},l.onTagRemoved=function(e){l.excludedMembers=l.excludedMembers.filter((function(n){return n.id!==e.id}))}}n.$inject=["$element","$timeout","_","elementScrollService","emailService","groupService","GROUP_OBJECT_TYPE"],e.module("linagora.esn.group").controller("GroupMemberAutoCompleteController",n)}(angular)},LtlO:function(e,n){!function(e){"use strict";function n(e){return{objectType:e,templateUrl:"/group/app/attendee/group-attendee-template.html"}}n.$inject=["GROUP_OBJECT_TYPE"],e.module("linagora.esn.group").factory("groupAttendeeProvider",n)}(angular)},"M9C+":function(e,n){!function(e){"use strict";e.module("linagora.esn.group").component("groupSelectionSelectAll",{templateUrl:"/group/app/common/selection/group-selection-select-all.html",controller:"groupSelectionSelectAllController",bindings:{items:"<"}})}(angular)},MNlq:function(e,n){!function(e){"use strict";e.module("linagora.esn.group").controller("GroupListSearchController",(function(){var e=this;e.clear=function(n){n.preventDefault(),n.stopPropagation(),e.onQuery({query:e.query=""})},e.doSearch=function(){e.onQuery({query:e.query})}}))}(angular)},MbaL:function(e,n){!function(e){"use strict";e.module("linagora.esn.group").component("groupSubheaderBackButton",{templateUrl:"/group/app/subheader/group-subheader-back-button.html"})}(angular)},Sdqo:function(e,n){!function(e){"use strict";function n(e,n,t,r,o,u,i,l,a,c){return{addMembers:function(t,r){if(!t||!t.id)return n.reject(new Error("group.id is required"));var l=r.length>1?"members":"member",c={progressing:"Adding "+l+"...",success:o.translate("Added %s "+l,r.length),failure:"Failed to add "+l};return u(c,(function(){return i.addMembers(t.id,r)})).then((function(n){e.$broadcast(a.GROUP_MEMBERS_ADDED,n.data)}))},create:function(t){if(!t)return n.reject(new Error("Group is required"));return u({progressing:"Creating group...",success:"Group created",failure:"Failed to create group"},(function(){return i.create(t)})).then((function(n){e.$broadcast(a.GROUP_CREATED,n.data)}))},deleteGroup:function(t){if(!t||!t.id)return n.reject(new Error("group ID is required"));return u({progressing:"Deleting group...",success:"Group deleted",failure:"Failed to delete group"},(function(){return i.deleteGroup(t.id)})).then((function(){e.$broadcast(a.GROUP_DELETED,t)}))},update:function(t){if(!t||!t.id)return n.reject(new Error("group.id is required"));var r={name:t.name,email:t.email};return u({progressing:"Updating group...",success:"Group updated",failure:"Failed to update group"},(function(){return i.update(t.id,r)})).then((function(n){e.$broadcast(a.GROUP_UPDATED,n.data)}))},removeMembers:function(n,t){var r=t.length>1?"members":"member",l={progressing:o.translate("Removing %s "+r+"...",t.length),success:o.translate("Removed %s "+r,t.length),failure:"Failed to remove "+r};return u(l,(function(){return i.removeMembers(n,t)})).then((function(){e.$broadcast(a.GROUP_MEMBERS_REMOVED,t)}))},searchMemberCandidates:function(e,n){var o={group:1,user:2,contact:3};return r.getAttendeeCandidates(e,20,["user","contact",c],n,t.identity).then((function(e){return e.filter((function(e){return e.email}))})).then((function(e){return t.chain(e).map((function(e){return e.priority=o[e.objectType]||0,e})).sortBy("priority").value()}))},isEmailAvailableToUse:function(e,n){return n=n||[],i.list({email:e}).then((function(t){var r=t.data[0];if(!r||n.some((function(e){return r.id===e.id})))return l.getUsersByEmail(e).then((function(e){return!e.data[0]}))}))},isGroupMemberEmail:function(e,n){return i.getMembers(e,{email:n}).then((function(e){return!(e.data&&e.data.length>0)}))}}}n.$inject=["$rootScope","$q","_","attendeeService","esnI18nService","asyncAction","groupApiClient","userAPI","GROUP_EVENTS","GROUP_OBJECT_TYPE"],e.module("linagora.esn.group").service("groupService",n)}(angular)},"So+R":function(e,n){!function(e){"use strict";function n(e,n){var t=this;t.$onInit=function(){t.isSelectedAll=!1},t.isSelecting=function(){return e.isSelecting()},t.getNumberOfSelectedItems=function(){return e.getSelectedItems().length},t.removeSelectedMembers=function(){var r=e.getSelectedItems().map((function(e){return{id:e.id,objectType:e.objectType}}));return n.removeMembers(t.group.id,r).then((function(){e.unselectAllItems()}))}}n.$inject=["groupSelectionService","groupService"],e.module("linagora.esn.group").controller("groupMemberListSelectionHeaderController",n)}(angular)},SvS5:function(e,n){!function(e){"use strict";function n(e){var n=new e.DynamicDirective(!0,"admin-groups-menu-item",{attributes:[{name:"display-in",value:"$ctrl.displayIn"}]});e.addInjection("admin-sidebar",n)}n.$inject=["dynamicDirectiveService"],e.module("linagora.esn.group").run(n)}(angular)},VTQ0:function(e,n){!function(e){"use strict";e.module("linagora.esn.group").constant("GROUP_OBJECT_TYPE","group").constant("GROUP_EVENTS",{GROUP_CREATED:"group:created",GROUP_UPDATED:"group:updated",GROUP_DELETED:"group:deleted",GROUP_MEMBERS_REMOVED:"group:members:removed",GROUP_MEMBERS_ADDED:"group:members:added"}).constant("GROUP_OBJECT_TYPE","group")}(angular)},Vby5:function(e,n){!function(e){"use strict";function n(e,n,t,r,o,u,i,l){var a=this,c=e.groupId;a.$onInit=function(){a.status="loading",u.get(c).then((function(e){a.group=e.data,a.status="loaded"})).catch((function(){a.status="error"})),t.$on(l.GROUP_UPDATED,(function(e,n){a.group=n})),t.$on(l.GROUP_DELETED,(function(){r.go("^")})),t.$on(l.GROUP_MEMBERS_REMOVED,(function(e,n){a.group.members=a.group.members.filter((function(e){return!o.find(n,e.member)}))})),t.$on(l.GROUP_MEMBERS_ADDED,(function(e,n){n.forEach((function(e){a.group.members.push({member:{id:e.id,objectType:e.objectType}})}))}))},a.onEditBtnClick=function(){n({templateUrl:"/group/app/update/group-update.html",backdrop:"static",placement:"center",controllerAs:"$ctrl",controller:"GroupUpdateController",locals:{group:a.group}})},a.deleteGroup=function(){return i.deleteGroup(a.group)}}n.$inject=["$stateParams","$modal","$scope","$state","_","groupApiClient","groupService","GROUP_EVENTS"],e.module("linagora.esn.group").controller("GroupDisplayController",n)}(angular)},ZOQz:function(e,n){!function(e){"use strict";function n(e,n,t,r){var o=this;o.group=t,o.addMembers=function(){var e=[];return o.newMembers.forEach((function(n){return"user"===n.objectType?e.push({id:n.id,objectType:"user"}):n.objectType===r?e.push({id:n.id,objectType:r}):void e.push({id:n.email,objectType:"email"})})),n.addMembers(o.group,e)}}n.$inject=["_","groupService","group","GROUP_OBJECT_TYPE"],e.module("linagora.esn.group").controller("GroupAddMembersController",n)}(angular)},ZTNP:function(e,n){!function(e){"use strict";e.module("linagora.esn.group").component("groupMemberListItemUser",{templateUrl:"/group/app/member/list-item-user/group-member-list-item-user.html",bindings:{member:"<"}})}(angular)},bAK3:function(e,n){!function(e){"use strict";e.module("linagora.esn.group").component("groupListSearch",{templateUrl:"/group/app/list/group-list-search.html",controller:"GroupListSearchController",bindings:{onQuery:"&"}})}(angular)},cG5k:function(e,n){!function(e){"use strict";function n(e,n){var t=this;t.emailAvailabilityChecker=function(n){return e.isEmailAvailableToUse(n,t.group?[t.group]:null)},t.domainName=n.domain.name}n.$inject=["groupService","session"],e.module("linagora.esn.group").controller("GroupFormController",n)}(angular)},elxr:function(e,n){!function(e){"use strict";e.module("linagora.esn.group").component("groupMemberAutoComplete",{templateUrl:"/group/app/member-auto-complete/group-member-auto-complete.html",controller:"GroupMemberAutoCompleteController",bindings:{newMembers:"=",group:"<",autofocus:"<"}})}(angular)},f104:function(e,n,t){"use strict";angular.module("linagora.esn.group").factory("groupRestangular",["Restangular","httpErrorHandler",function(e,n){return e.withConfig((function(e){e.setFullResponse(!0),e.setBaseUrl("/group/api"),e.setErrorInterceptor((function(e){return 401===e.status&&n.redirectToLogin(),!0}))}))}])},f6zk:function(e,n){!function(e){"use strict";function n(n){var t=[],r=!1;return{isSelecting:function(){return r},getSelectedItems:function(){return n.clone(t)},toggleItemSelection:function(o,u){var i=e.isDefined(u)?u:!o.selected;o.selected!==i&&(o.selected=i,i?t.push(o):n.pull(t,o),r=t.length>0)},unselectAllItems:function(){t.forEach((function(e){e.selected=!1})),t.length=0,r=!1}}}n.$inject=["_"],e.module("linagora.esn.group").factory("groupSelectionService",n)}(angular)},f8Gw:function(e,n){!function(e){"use strict";function n(e,n){var t=this;t.group=n,t.update=function(){return e.update(t.group)}}n.$inject=["groupService","group"],e.module("linagora.esn.group").controller("GroupUpdateController",n)}(angular)},fFpz:function(e,n){!function(e){"use strict";e.module("linagora.esn.group").component("groupMemberList",{templateUrl:"/group/app/member/list/group-member-list.html",controller:"GroupMemberListController",bindings:{group:"<"}})}(angular)},hx5j:function(e,n){!function(e){"use strict";e.module("linagora.esn.group").component("groupMemberListItemGroup",{templateUrl:"/group/app/member/list-item-group/group-member-list-item-group.html",bindings:{member:"<"}})}(angular)},iZOy:function(e,n){!function(e){"use strict";function n(e){return{restrict:"A",link:function(n,t){n.$watch((function(){return e.isSelecting()}),(function(e){e?t.addClass("hidden"):t.removeClass("hidden")}))}}}n.$inject=["groupSelectionService"],e.module("linagora.esn.group").directive("groupSelectionHideOnSelecting",n)}(angular)},lYZu:function(e,n){!function(e){"use strict";function n(e){return{restrict:"E",transclude:!0,templateUrl:"/group/app/common/selection/group-selectable.html",link:function(n){n.toggle=function(){e.toggleItemSelection(n.item)}},scope:{item:"="}}}n.$inject=["groupSelectionService"],e.module("linagora.esn.group").directive("groupSelectable",n)}(angular)},n1Yi:function(e,n){!function(e){"use strict";e.module("linagora.esn.group").component("adminGroups",{templateUrl:"/group/app/admin/admin-groups.html"})}(angular)},oKFj:function(e,n){!function(e){"use strict";function n(e,n,t,r,o,u,i){var l=this,a=i||20,c={offset:0,limit:a};function s(){return c.offset=l.elements.length,o.getMembers(l.group.id,c).then((function(e){return e.data}))}l.$onInit=function(){l.loadMoreElements=r(l,s,null,a),e.$on(u.GROUP_MEMBERS_REMOVED,(function(e,n){n.forEach((function(e){t.remove(l.elements,e)}))})),e.$on(u.GROUP_MEMBERS_ADDED,(function(e,n){n.forEach((function(e){l.elements.unshift(e)}))}))},l.onAddMembersBtnClick=function(){n({templateUrl:"/group/app/update/members/group-add-members.html",backdrop:"static",placement:"center",controllerAs:"$ctrl",controller:"GroupAddMembersController",locals:{group:l.group}})}}n.$inject=["$scope","$modal","_","infiniteScrollHelper","groupApiClient","GROUP_EVENTS","ELEMENTS_PER_REQUEST"],e.module("linagora.esn.group").controller("GroupMemberListController",n)}(angular)},pofz:function(e,n){!function(e){"use strict";e.module("linagora.esn.group").component("groupList",{templateUrl:"/group/app/list/group-list.html",controller:"GroupListController"})}(angular)},tFfR:function(e,n,t){"use strict";angular.module("linagora.esn.group").component("groupDisplaySubheader",{templateUrl:"/group/app/display/subheader/group-display-subheader.html",bindings:{group:"<",onDeleteBtnClick:"&"}})},"uI/m":function(e,n){!function(e){"use strict";e.module("linagora.esn.group").component("groupListItem",{templateUrl:"/group/app/list/item/group-list-item.html",bindings:{group:"<",onDeleteBtnClick:"&"}})}(angular)},uhLr:function(e,n){!function(e){"use strict";e.module("linagora.esn.group").component("groupMemberListSelectionHeader",{templateUrl:"/group/app/member/list/selection-header/group-member-list-selection-header.html",controller:"groupMemberListSelectionHeaderController",bindings:{group:"<",members:"<",total:"<"}})}(angular)},vBWL:function(e,n){!function(e){"use strict";e.module("linagora.esn.group").component("groupMemberValidateMessage",{templateUrl:"/group/app/member-auto-complete/validate-message/group-member-validate-message.html",bindings:{error:"<"}})}(angular)},vSUO:function(e,n){!function(e){"use strict";function n(e){var n=this;n.create=function(){return n.group.members=function(e){return e.map((function(e){return e.email}))}(n.newMembers),e.create(n.group)},n.newMembers=[]}n.$inject=["groupService"],e.module("linagora.esn.group").controller("GroupCreateController",n)}(angular)}});